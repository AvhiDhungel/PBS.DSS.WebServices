@inherits LayoutComponentBase

<MudProviders />

<MudLayout>
    <MudAppBar Elevation="1" Dense="true">
        <MudSpacer />
        <MudStack Row="true">
            <MudButton Style="color:white;" OnClick="SetLanguageEN">EN</MudButton>
            <MudButton Style="color:white;" OnClick="SetLanguageFR">FR</MudButton>
        </MudStack>
    </MudAppBar>
    <MudMainContent>
        <MudPageBanner Banner="@SharedStateService.GetBanner()" />
        <MudContainer MaxWidth="MaxWidth.Large" Class="main-container justify-center align-center">
            @Body
        </MudContainer>
    </MudMainContent>
</MudLayout>

@code {
    private async Task SetLanguageEN() { await SetCulture("en-CA"); }
    private async Task SetLanguageFR() { await SetCulture("fr-CA"); }

    protected async override Task OnInitializedAsync()
    {
        //Debug Code
        var banner = await httpClient.GetByteArrayAsync("banner.png");
        SharedStateService.SetBanner(Convert.ToBase64String(banner));
    }

    protected override void OnInitialized()
    {
        SharedStateService.RefreshMainLayout = StateHasChanged;
    }

    private async Task SetCulture(string c)
    {
        var cInfo = System.Globalization.CultureInfo.GetCultureInfo(c);

        if (System.Globalization.CultureInfo.CurrentCulture.Name == cInfo.Name) return;

        await SessionStorageService.SetSessionCulture(cInfo.Name);

        NavigationManager.Refresh();
    }
}